# 21 天打卡行动

#21 天打卡# Day31
专栏：kafka 核心技术与实战
时间：2020-03-24
学习：12
学习要点和总结：

一、[12 | 客户端都有哪些不常见但是很高级的功能？](https://time.geekbang.org/column/article/103397)

1. 拦截器概念：基本思想就是允许应用程序在不修改逻辑的情况下，动态地实现一组可插拔的事件处理逻辑链。它能够在主业务操作的前后多个时间点上插入对应的"拦截"逻辑。
2. Kafka 拦截器，可以在消息处理的前后多个时点动态植入不同的处理逻辑。
3. Kafka 拦截器分为生产者拦截器和消费者拦截器。生产者拦截器允许你在发送消息前以及消息提交成功后植入你的拦截器逻辑；而消费者拦截器支持在消费消息前以及提交位移后编写特定逻辑。两种拦截器都支持链的方式，即你可以将一组拦截器串连成一个大的拦截器，Kafka 会按照添加顺序依次执行拦截器逻辑。
4. 当前 Kafka 拦截器的设置方法是通过参数配置完成的。生产者和消费者两端有一个相同的参数，名字叫 interceptor.classes，它指定的是一组类的列表，每个类就是特定逻辑的拦截器实现类。
5. 你自己编写的所有 Producer 端拦截器实现类都要继承 org.apache.kafka.clients.producer.ProducerInterceptor 接口。两个核心方法：onSend：该方法会在消息发送之前被调用。onAcknowledgement：该方法会在消息成功提交或发送失败之后被调用。
6. 指定消费者拦截器也是同样的方法，只是具体的实现类要实现 org.apache.kafka.clients.consumer.ConsumerInterceptor 接口，这里面也有两个核心方法。onConsume：该方法在消息返回给 Consumer 程序之前调用。onCommit：Consumer 在提交位移之后调用该方法。
7. 指定拦截器类时要指定它们的全限定名，即 full qualified name。通俗点说就是要把完整包名也加上
8. Kafka 拦截器可以应用于包括客户端监控、端到端系统性能检测、消息审计等多种功能在内的场景。
